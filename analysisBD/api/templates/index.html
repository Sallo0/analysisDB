<!DOCTYPE html>
<html lang="ru">
<head>
    {% load static %}
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Пример веб-страницы</title>
    <link rel="stylesheet" href="{% static 'css/index.css' %}">
 </head>
 <body>
  <h1>Анализ баз данных</h1>
  <!-- Комментарий -->
  <div>
      <a href="postgresql"><button type="button">PostgreSQL</button></a>
      <a href="orientdb"><button type="button">OrientDB</button></a>
      <a href="neo4j"><button type="button">Neo4j</button></a>

       <form class="requestForm">
           <select class="select-db" required>
               <option selected value="PostgreSQL">PostgreSQL</option>
               <option value="OrientDB">OrientDB</option>
               <option value="Neo4j">Neo4j</option>
           </select>

           <select class="select-mainFilter" onchange="displayInput()" required>
               <option class="option-none" value="-">-</option>
               <option value="Child">Child</option>
               <option value="Parent">Parent</option>
               <option value="All">All</option>
           </select>

           <div class="filter-input">
               <input class="child" type="text" placeholder="child...">
               <input class="parent" type="text" placeholder="parent...">
           </div>

           <select class="select-kind">
               <option value="1">1</option>
               <option value="2">2</option>
               <option value="3">3</option>
               <option value="4">4</option>
               <option value="5">5</option>
               <option value="6">6</option>
           </select>

           <input type="date" class="date-begin">
           <input type="date" class="date-end">
           <input type="text" class="cost">
           <input type="text" class="share">

           <select class="select-childLiquidated">
               <option selected value="-">-</option>
               <option value="false">Нет</option>
               <option value="true">Да</option>
           </select>

           <input type="submit" value="Отправить" onclick="sendRequest()">
       </form>
  </div>
    <script>
        function displayInput(){
            let selectBox = document.querySelector(".select-mainFilter");
            let selectedValue = selectBox.options[selectBox.selectedIndex].value;
            document.querySelector(".filter-input").style.display = "inline-block";

            let option = document.querySelector(".option-none");
            if (option != null) document.querySelector(".option-none").remove();

            if (selectedValue === "Child") {
                document.querySelector(".parent").style.display = "none";
                document.querySelector(".child").style.display = "block";
            }else if (selectedValue === "Parent"){
                document.querySelector(".parent").style.display = "block";
                document.querySelector(".child").style.display = "none";
            }else if (selectedValue === "All"){
                document.querySelector(".child").style.display = "block";
                document.querySelector(".parent").style.display = "block";
            }
        }

        function sendRequest(){

            let selectBox = document.querySelector(".select-db");
            let selectedValue = selectBox.options[selectBox.selectedIndex].value;

            let data = { 'dbtype': selectedValue }

            fetch(`http://46.48.3.74:8000/` + "api/postgresql/getdata", {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json;charset=utf-8'
                },
                body: JSON.stringify(data)
            })
            .then(response => {
                if (response.ok) {
                    alert("ok")
                }
            });
        }
    </script>
 </body>
</html>